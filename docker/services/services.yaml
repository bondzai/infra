services:
  base_service: &base
    init: true
    restart: always

  influx:
    <<: *base
    image: ${INFLUX_IMAGE:-influxdb:latest}
    container_name: influx-con
    hostname: influx
    ports:
      - "8086:8086"

  postgres:
    <<: *base
    image: ${POSTGRES_IMAGE:-postgres:13-alpine3.17}
    container_name: postgres-con
    hostname: postgres
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_USER=jb
      - POSTGRES_PASSWORD=12345678
      - POSTGRES_DB=init

  pgadmin:
    <<: *base
    image: ${PGADMIN_IMAGE:-dpage/pgadmin4:latest}
    container_name: pgadmin-con
    hostname: pgadmin
    environment:
      - PGADMIN_DEFAULT_EMAIL=${PGADMIN_DEFAULT_EMAIL:-admin@jb.dev}
      - PGADMIN_DEFAULT_PASSWORD=${PGADMIN_DEFAULT_PASSWORD:-jb12345}
    ports:
      - ${PGADMIN_PORT:-5050}:80

  mongo:
    <<: *base
    image: mongo:latest
    container_name: mongo-con
    hostname: mongo
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: root
    ports:
      - "${PORT:-27017}:27017"

  mysql:
    <<: *base
    image: mysql:latest
    container_name: mysql-con
    hostname: mysql
    command: --default-authentication-plugin=mysql_native_password
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: init
    ports:
      - "3306:3306"

  phpmyadmin:
    <<: *base
    image: phpmyadmin/phpmyadmin:latest
    container_name: phpmyadmin-con
    hostname: phpmyadmin
    environment:
      PMA_HOST: mysql
      PMA_PORT: 3306
      PMA_USER: root
      PMA_PASSWORD: root
    ports:
      - "8080:80"
    depends_on:
      - mysql
